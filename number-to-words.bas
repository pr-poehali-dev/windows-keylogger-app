Function ЧислоПрописью(Число As Currency) As String
    Dim Рубли As Long
    Dim Копейки As Long
    Dim Результат As String
    
    Рубли = Int(Число)
    Копейки = Round((Число - Рубли) * 100)
    
    Результат = ЧислоВТекст(Рубли) & " " & СклонениеРубль(Рубли) & " "
    Результат = Результат & Format(Копейки, "00") & " " & СклонениеКопейка(Копейки)
    
    ЧислоПрописью = UCase(Left(Результат, 1)) & Mid(Результат, 2)
End Function

Function ЧислоВТекст(Число As Long) As String
    Dim Единицы() As String
    Dim Десятки() As String
    Dim Сотни() As String
    Dim Разряды() As String
    Dim Результат As String
    Dim Триада As Long
    Dim Остаток As Long
    Dim i As Integer
    
    Единицы = Split("ноль один два три четыре пять шесть семь восемь девять")
    Десятки = Split("десять одиннадцать двенадцать тринадцать четырнадцать пятнадцать шестнадцать семнадцать восемнадцать девятнадцать")
    
    If Число = 0 Then
        ЧислоВТекст = "ноль"
        Exit Function
    End If
    
    Результат = ""
    i = 0
    
    Do While Число > 0
        Триада = Число Mod 1000
        Число = Число \ 1000
        
        If Триада > 0 Then
            Dim ТекстТриады As String
            ТекстТриады = ТриадаВТекст(Триада, i)
            
            If i = 1 Then
                ТекстТриады = ТекстТриады & " " & СклонениеТысяча(Триада)
            ElseIf i = 2 Then
                ТекстТриады = ТекстТриады & " " & СклонениеМиллион(Триада)
            ElseIf i = 3 Then
                ТекстТриады = ТекстТриады & " " & СклонениеМиллиард(Триада)
            End If
            
            Результат = ТекстТриады & " " & Результат
        End If
        
        i = i + 1
    Loop
    
    ЧислоВТекст = Trim(Результат)
End Function

Function ТриадаВТекст(Триада As Long, Разряд As Integer) As String
    Dim Сотни() As String
    Dim ДесяткиТекст() As String
    Dim Единицы() As String
    Dim ЕдиницыЖен() As String
    Dim ОтДесятиДоДевятнадцати() As String
    Dim Результат As String
    Dim Сот As Integer, Дес As Integer, Ед As Integer
    
    Сотни = Split(" сто двести триста четыреста пятьсот шестьсот семьсот восемьсот девятьсот")
    ДесяткиТекст = Split(" десять двадцать тридцать сорок пятьдесят шестьдесят семьдесят восемьдесят девяносто")
    Единицы = Split(" один два три четыре пять шесть семь восемь девять")
    ЕдиницыЖен = Split(" одна две три четыре пять шесть семь восемь девять")
    ОтДесятиДоДевятнадцати = Split("десять одиннадцать двенадцать тринадцать четырнадцать пятнадцать шестнадцать семнадцать восемнадцать девятнадцать")
    
    Сот = Триада \ 100
    Дес = (Триада Mod 100) \ 10
    Ед = Триада Mod 10
    
    Результат = ""
    
    If Сот > 0 Then Результат = Сотни(Сот)
    
    If Дес = 1 Then
        Результат = Trim(Результат) & " " & ОтДесятиДоДевятнадцати(Ед)
    Else
        If Дес > 1 Then Результат = Trim(Результат) & " " & ДесяткиТекст(Дес)
        
        If Ед > 0 Then
            If Разряд = 1 Then
                Результат = Trim(Результат) & " " & ЕдиницыЖен(Ед)
            Else
                Результат = Trim(Результат) & " " & Единицы(Ед)
            End If
        End If
    End If
    
    ТриадаВТекст = Trim(Результат)
End Function

Function СклонениеРубль(Число As Long) As String
    Dim Остаток As Integer
    Остаток = Abs(Число) Mod 100
    
    If Остаток >= 11 And Остаток <= 19 Then
        СклонениеРубль = "рублей"
    Else
        Остаток = Abs(Число) Mod 10
        Select Case Остаток
            Case 1: СклонениеРубль = "рубль"
            Case 2, 3, 4: СклонениеРубль = "рубля"
            Case Else: СклонениеРубль = "рублей"
        End Select
    End If
End Function

Function СклонениеКопейка(Число As Long) As String
    Dim Остаток As Integer
    Остаток = Abs(Число) Mod 100
    
    If Остаток >= 11 And Остаток <= 19 Then
        СклонениеКопейка = "копеек"
    Else
        Остаток = Abs(Число) Mod 10
        Select Case Остаток
            Case 1: СклонениеКопейка = "копейка"
            Case 2, 3, 4: СклонениеКопейка = "копейки"
            Case Else: СклонениеКопейка = "копеек"
        End Select
    End If
End Function

Function СклонениеТысяча(Число As Long) As String
    Dim Остаток As Integer
    Остаток = Abs(Число) Mod 100
    
    If Остаток >= 11 And Остаток <= 19 Then
        СклонениеТысяча = "тысяч"
    Else
        Остаток = Abs(Число) Mod 10
        Select Case Остаток
            Case 1: СклонениеТысяча = "тысяча"
            Case 2, 3, 4: СклонениеТысяча = "тысячи"
            Case Else: СклонениеТысяча = "тысяч"
        End Select
    End If
End Function

Function СклонениеМиллион(Число As Long) As String
    Dim Остаток As Integer
    Остаток = Abs(Число) Mod 100
    
    If Остаток >= 11 And Остаток <= 19 Then
        СклонениеМиллион = "миллионов"
    Else
        Остаток = Abs(Число) Mod 10
        Select Case Остаток
            Case 1: СклонениеМиллион = "миллион"
            Case 2, 3, 4: СклонениеМиллион = "миллиона"
            Case Else: СклонениеМиллион = "миллионов"
        End Select
    End If
End Function

Function СклонениеМиллиард(Число As Long) As String
    Dim Остаток As Integer
    Остаток = Abs(Число) Mod 100
    
    If Остаток >= 11 And Остаток <= 19 Then
        СклонениеМиллиард = "миллиардов"
    Else
        Остаток = Abs(Число) Mod 10
        Select Case Остаток
            Case 1: СклонениеМиллиард = "миллиард"
            Case 2, 3, 4: СклонениеМиллиард = "миллиарда"
            Case Else: СклонениеМиллиард = "миллиардов"
        End Select
    End If
End Function
